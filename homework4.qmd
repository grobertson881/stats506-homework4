---
title: "Homework 4"
format:
  html:
    embed-resources: true
editor: visual
---

Link to Github repository: https://github.com/grobertson881/stats506-homework4

**Problem 1** 

```{r}
#install.packages("nzelect")
library(nzelect)
library(tidyverse)
nzge <- nzelect::nzge
```

*Part A*
```{r}
vote_count <- nzge %>% 
  select(votes, election_year, voting_type) %>%
  group_by(election_year, voting_type) %>% 
  summarize(total_vote_count = sum(votes)) %>% 
  arrange(total_vote_count)

vote_count
```

*Part B*
```{r}
votes_2014 <- nzge %>% 
  filter(election_year == 2014, voting_type == "Candidate") %>% 
  group_by(party) %>% 
  summarize(party_total_votes = sum(votes)) %>% 
  ungroup() %>% 
  mutate(vote_proportion = party_total_votes / sum(party_total_votes) * 100) %>% 
  select(-party_total_votes) %>% 
  arrange(desc(vote_proportion))
  
votes_2014
```

*Part C*
```{r}
winning_party <- nzge %>% 
  group_by(election_year, voting_type) %>% 
  filter(votes == max(votes)) %>% 
  select(election_year, voting_type, party)
  
winning_party
```

**Problem 2**
```{r}
tennis <- read_csv("https://raw.githubusercontent.com/JeffSackmann/tennis_atp/refs/heads/master/atp_matches_2019.csv")
```

*Part A*
```{r}
tourney_2019 <- tennis %>% 
  mutate(tourney_date = as.character(tourney_date)) %>% 
  filter(str_sub(tourney_date, 1, 4) == "2019") %>% 
  summarise(num_tourneys_2019 = n_distinct(tourney_id))

tourney_2019
```
There were 125 tournaments in 2019. 

*Part B*
```{r}
# winner of tourney is winner of final round
player_wins <- tennis %>% 
  filter(round == "F") %>% 
  group_by(winner_name) %>% 
  summarize(win_count = n()) %>% 
  arrange(desc(win_count))

player_wins
```

Yes, there are 12 players who have won more than one tournament. 
Dominic Thiem and Novak Djokovic have won the most tournaments with 5 wins. 

*Part C*
```{r}
ace_data <- tennis %>%
  select(w_ace, l_ace) %>%
  pivot_longer(cols = c(w_ace, l_ace),
               names_to = "result", values_to = "aces") %>%
  mutate(result = if_else(result == "w_ace", "W", "L"))

library(infer)

win_ace_hypothesis <- ace_data %>%
  t_test(aces ~ result, alternative = "greater")

win_ace_hypothesis

```

There is no evidence that winners have more aces than the losers. The p-value of 1 shows there is no statistical proof. 

*Part D*
```{r}
match_data <- tennis %>%
  select(winner_name, loser_name) %>%
  pivot_longer(cols = c(winner_name, loser_name),
               names_to = "result", values_to = "player_name") %>%
  mutate(win = if_else(result == "winner_name", 1, 0))

winning_rate <- match_data %>% 
  group_by(player_name) %>% 
  summarize(
    matches_played = n(),
    wins = sum(win),
    winning_rate = wins/matches_played
  ) %>% 
  filter(matches_played >= 5) %>% 
  arrange(desc(winning_rate))

winning_rate
```

The player with the highest winning rate is Rafael Nadal with 86.96% of his games being wins. 

**Problem 3**
```{r}
covid <- read_csv("https://raw.githubusercontent.com/nytimes/covid-19-data/refs/heads/master/rolling-averages/us-states.csv")
```

*Part A*
```{r}
cases_total <- covid %>% 
  group_by(date) %>% 
  summarize(new_cases = sum(cases, na.rm = TRUE)) %>% 
  arrange(date)

# add find peaks and add to graph

ggplot(cases_total, aes(x = date, y = new_cases)) + 
  geom_line(linewidth = 0.3)

```

Answer:

*Part B*
```{r}

```

Answer: 

*Part C*
```{r}

```

Answer: 











